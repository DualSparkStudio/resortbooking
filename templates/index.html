{% extends "base.html" %}

{% block title %}Luxury Resort - Paradise Awaits{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section">
    <div id="heroCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" data-bs-interval="5000">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="0" class="active"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="1"></button>
            <button type="button" data-bs-target="#heroCarousel" data-bs-slide-to="2"></button>
        </div>
        
        <div class="carousel-inner">
            <div class="carousel-item active">
                <div class="hero-slide" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1571896349842-33c89424de2d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') center/cover;">
                    <div class="container h-100 d-flex align-items-center">
                        <div class="row justify-content-center text-center text-white">
                            <div class="col-lg-8">
                                <h1 class="display-3 fw-bold mb-4 luxury-title">Welcome to Paradise</h1>
                                <p class="lead mb-5">Experience luxury redefined at our world-class resort where every moment becomes a cherished memory.</p>
                                <a href="{{ url_for('rooms') }}" class="btn btn-luxury btn-lg me-3">Book Your Stay</a>
                                <a href="{{ url_for('about') }}" class="btn btn-outline-light btn-lg">Learn More</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="carousel-item">
                <div class="hero-slide" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1544986581-efac024faf62?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') center/cover;">
                    <div class="container h-100 d-flex align-items-center">
                        <div class="row justify-content-center text-center text-white">
                            <div class="col-lg-8">
                                <h1 class="display-3 fw-bold mb-4 luxury-title">Luxury Accommodations</h1>
                                <p class="lead mb-5">Indulge in our exquisitely designed suites and rooms, each offering breathtaking views and unmatched comfort.</p>
                                <a href="{{ url_for('rooms') }}" class="btn btn-luxury btn-lg me-3">View Rooms</a>
                                <a href="{{ url_for('facilities') }}" class="btn btn-outline-light btn-lg">Our Facilities</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="carousel-item">
                <div class="hero-slide" style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?ixlib=rb-4.0.3&auto=format&fit=crop&w=1920&q=80') center/cover;">
                    <div class="container h-100 d-flex align-items-center">
                        <div class="row justify-content-center text-center text-white">
                            <div class="col-lg-8">
                                <h1 class="display-3 fw-bold mb-4 luxury-title">World-Class Amenities</h1>
                                <p class="lead mb-5">From spa treatments to gourmet dining, discover a world of luxury amenities designed for your ultimate relaxation.</p>
                                <a href="{{ url_for('facilities') }}" class="btn btn-luxury btn-lg me-3">Explore Facilities</a>
                                <a href="{{ url_for('contact') }}" class="btn btn-outline-light btn-lg">Contact Us</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon"></span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon"></span>
        </button>
    </div>
</section>

<!-- Quick Booking Section -->
<section class="py-5 bg-cream-beige">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="card shadow-lg border-0 rounded-4">
                    <div class="card-body p-4">
                        <h3 class="text-center mb-4 text-forest">Quick Room Search</h3>
                        <form class="row g-3 align-items-end">
                            <div class="col-md-3">
                                <label for="checkIn" class="form-label">Check-in</label>
                                <input type="date" class="form-control" id="checkIn" required>
                            </div>
                            <div class="col-md-3">
                                <label for="checkOut" class="form-label">Check-out</label>
                                <input type="date" class="form-control" id="checkOut" required>
                            </div>
                            <div class="col-md-2">
                                <label for="guests" class="form-label">Guests</label>
                                <select class="form-select" id="guests">
                                    <option value="1">1 Guest</option>
                                    <option value="2" selected>2 Guests</option>
                                    <option value="3">3 Guests</option>
                                    <option value="4">4 Guests</option>
                                    <option value="5">5+ Guests</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="roomType" class="form-label">Room Type</label>
                                <select class="form-select" id="roomType">
                                    <option value="">Any Room</option>
                                    {% for room_type in room_types %}
                                    <option value="{{ room_type.id }}">{{ room_type.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-luxury w-100">
                                    <i class="fas fa-search me-2"></i>Search
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- About Section -->
<section class="py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <div class="pe-lg-4">
                    <h2 class="luxury-title mb-4">Experience Unparalleled Luxury</h2>
                    <p class="lead text-muted mb-4">
                        Nestled in the heart of paradise, our luxury resort offers an extraordinary escape from the ordinary. 
                        With breathtaking ocean views, world-class amenities, and personalized service, we create unforgettable 
                        experiences for our distinguished guests.
                    </p>
                    <div class="row">
                        <div class="col-6">
                            <div class="text-center">
                                <div class="luxury-stat-number">150+</div>
                                <div class="text-muted">Luxury Rooms</div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="text-center">
                                <div class="luxury-stat-number">50+</div>
                                <div class="text-muted">Premium Amenities</div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4">
                        <a href="{{ url_for('about') }}" class="btn btn-luxury">Learn More About Us</a>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="position-relative">
                    <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
                         alt="Luxury Resort Interior" class="img-fluid rounded-4 shadow">
                    <div class="luxury-badge">
                        <i class="fas fa-award text-warning mb-2"></i>
                        <div class="small">5-Star</div>
                        <div class="small">Luxury Resort</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Featured Rooms Section -->
<section class="py-5 bg-seafoam">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="luxury-title text-forest">Featured Accommodations</h2>
            <p class="lead text-sage">Discover our most popular luxury rooms and suites</p>
        </div>
        
        <div class="row">
            {% for room_type in room_types %}
            <div class="col-lg-4 mb-4">
                <div class="card h-100 border-0 shadow-lg room-card">
                    <div class="room-image-container">
                        <img src="{{ room_type.get_primary_image() or 'https://images.unsplash.com/photo-1611892440504-42a792e24d32?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80' }}" 
                             class="card-img-top room-image" alt="{{ room_type.name }}">
                        <div class="room-price-badge">
                            <span class="room-price">{{ format_currency(room_type.price_per_night) }}</span>
                            <span class="room-price-period">/night</span>
                        </div>
                    </div>
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">{{ room_type.name }}</h5>
                        <p class="card-text text-muted flex-grow-1">{{ room_type.description[:100] }}...</p>
                        <div class="room-features mb-3">
                            <span class="badge bg-light text-dark me-2">
                                <i class="fas fa-users me-1"></i>{{ room_type.max_occupancy }} Guests
                            </span>
                            <span class="badge bg-light text-dark">
                                <i class="fas fa-wifi me-1"></i>Free WiFi
                            </span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('room_detail', room_type_id=room_type.id) }}" class="btn btn-outline-primary">View Details</a>
                            <a href="{{ url_for('book_room', room_type_id=room_type.id) }}" class="btn btn-luxury">Book Now</a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="{{ url_for('rooms') }}" class="btn btn-outline-primary btn-lg">View All Rooms</a>
        </div>
    </div>
</section>

<!-- Features Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="luxury-title">Exclusive Features</h2>
            <p class="lead text-muted">Experience luxury with our innovative booking system</p>
        </div>
        
        <div class="row">
            <div class="col-lg-4 mb-4">
                <div class="text-center feature-item">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-calendar-alt fa-3x text-primary"></i>
                    </div>
                    <h5>Interactive Calendar</h5>
                    <p class="text-muted">View real-time room availability, resort closures, and detailed information for each date. Our dynamic calendar provides complete transparency for your booking decisions.</p>
                </div>
            </div>
            <div class="col-lg-4 mb-4">
                <div class="text-center feature-item">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-clock fa-3x text-success"></i>
                    </div>
                    <h5>Real-Time Updates</h5>
                    <p class="text-muted">Get instant updates on room availability, pricing, and resort status. Never miss out on your preferred dates with our live booking system.</p>
                </div>
            </div>
            <div class="col-lg-4 mb-4">
                <div class="text-center feature-item">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-info-circle fa-3x text-warning"></i>
                    </div>
                    <h5>Detailed Information</h5>
                    <p class="text-muted">Access comprehensive details about each date including room availability, special rates, and resort closure information before making your booking.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Facilities Section -->
<section class="py-5">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="luxury-title">World-Class Facilities</h2>
            <p class="lead text-muted">Indulge in our exceptional amenities and services</p>
        </div>
        
        <div class="row">
            {% for facility in facilities %}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="text-center facility-item">
                    <div class="facility-icon mb-3">
                        <i class="{{ facility.icon or 'fas fa-star' }}"></i>
                    </div>
                    <h5>{{ facility.name }}</h5>
                    <p class="text-muted">{{ facility.description }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
        
        <div class="text-center mt-4">
            <a href="{{ url_for('facilities') }}" class="btn btn-outline-primary btn-lg">Explore All Facilities</a>
        </div>
    </div>
</section>

<!-- Testimonials Section -->
{% if testimonials %}
<section class="py-5 bg-light">
    <div class="container">
        <div class="text-center mb-5">
            <h2 class="luxury-title">What Our Guests Say</h2>
            <p class="lead text-muted">Real experiences from our valued guests</p>
        </div>
        
        <div class="row">
            {% for testimonial in testimonials %}
            <div class="col-lg-4 mb-4">
                <div class="card h-100 border-0 shadow-sm testimonial-card">
                    <div class="card-body text-center">
                        <div class="testimonial-rating mb-3">
                            {{ get_star_rating(testimonial.rating)|safe }}
                        </div>
                        <blockquote class="blockquote">
                            <p class="mb-3">"{{ testimonial.comment }}"</p>
                        </blockquote>
                        <footer class="blockquote-footer">
                            <strong>{{ testimonial.guest_name }}</strong>
                        </footer>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Call to Action Section -->
<section class="py-5 cta-section">
    <div class="container">
        <div class="row justify-content-center text-center text-white">
            <div class="col-lg-8">
                <h2 class="display-5 fw-bold mb-4">Ready for Your Dream Vacation?</h2>
                <p class="lead mb-5">Book your stay today and experience luxury like never before. Our team is ready to make your perfect getaway a reality.</p>
                <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center">
                    <a href="{{ url_for('rooms') }}" class="btn btn-light btn-lg px-5">
                        <i class="fas fa-bed me-2"></i>Book Your Room
                    </a>
                    <a href="{{ url_for('contact') }}" class="btn btn-outline-light btn-lg px-5">
                        <i class="fas fa-phone me-2"></i>Contact Us
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_scripts %}
<script>
$(document).ready(function() {
    // Set minimum date for check-in to today
    const today = new Date().toISOString().split('T')[0];
    $('#checkIn').attr('min', today);
    
    // Initialize with global date manager
    if (window.DateSelectionManager) {
        // Load stored dates into quick search form
        if (DateSelectionManager.getFormattedCheckIn()) {
            $('#checkIn').val(DateSelectionManager.getFormattedCheckIn());
        }
        if (DateSelectionManager.getFormattedCheckOut()) {
            $('#checkOut').val(DateSelectionManager.getFormattedCheckOut());
        }
        
        // Add listeners to update global storage when form changes
        $('#checkIn').on('change', function() {
            if (this.value) {
                DateSelectionManager.setCheckInDate(new Date(this.value));
            } else {
                DateSelectionManager.setCheckInDate(null);
            }
        });
        
        $('#checkOut').on('change', function() {
            if (this.value) {
                DateSelectionManager.setCheckOutDate(new Date(this.value));
            } else {
                DateSelectionManager.setCheckOutDate(null);
            }
        });
    }
    
    // Update check-out minimum date when check-in changes
    $('#checkIn').change(function() {
        const checkInDate = new Date(this.value);
        checkInDate.setDate(checkInDate.getDate() + 1);
        const minCheckOut = checkInDate.toISOString().split('T')[0];
        $('#checkOut').attr('min', minCheckOut);
        
        if ($('#checkOut').val() && $('#checkOut').val() <= this.value) {
            $('#checkOut').val(minCheckOut);
        }
    });
    
    // Handle quick search form
    $('form').submit(function(e) {
        e.preventDefault();
        const checkIn = $('#checkIn').val();
        const checkOut = $('#checkOut').val();
        const guests = $('#guests').val();
        const roomType = $('#roomType').val();
        
        // Store selected dates in global manager
        if (window.DateSelectionManager) {
            if (checkIn) DateSelectionManager.setCheckInDate(new Date(checkIn));
            if (checkOut) DateSelectionManager.setCheckOutDate(new Date(checkOut));
            if (roomType) DateSelectionManager.setRoomTypeId(roomType);
        }
        
        // Build URL with parameters
        let targetUrl;
        if (roomType) {
            targetUrl = "{{ url_for('book_room', room_type_id=1) }}".replace('1', roomType);
        } else {
            targetUrl = "{{ url_for('rooms') }}";
        }
        
        // Add URL parameters for compatibility
        const params = new URLSearchParams();
        if (checkIn) params.append('check_in', checkIn);
        if (checkOut) params.append('check_out', checkOut);
        if (guests) params.append('guests', guests);
        
        if (params.toString()) {
            targetUrl += '?' + params.toString();
        }
        
        window.location.href = targetUrl;
    });
});
</script>
{% endblock %}
